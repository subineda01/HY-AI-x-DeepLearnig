# HY-AI-x-DeepLearnig
Members : 
이가빈, 화학과, gabin0713@hanyang.ac.kr
장수빈, 수학과,
박승현, 경영학부,
이상백, 기계공학부,

🔍 목차
1. Proposal
2. DataSets
3. Methodology
4. Evaluation & Analysis
5. Related Works

-------------------------
# I.Proposal
- Why are you doing this?

딥러닝을 이용한 감정 인식 기술은 우리가 미처 알지 못했던 인간의 감정 패턴과 심리 상태를 더 깊이 이해할 수 있게 해줍니다. 이러한 기술은 다음과 같은 여러 측면에서 인류 발전에 크게 기여할 수 있습니다.

정신 건강 관리의 혁신
감정 분류 시스템을 통해 사람들의 온라인 활동과 소셜 미디어 게시물에서 감정을 분석하면, 우울증, 불안, 스트레스 등의 정신 건강 문제를 조기에 발견할 수 있습니다. 이는 정신 건강 전문가들이 보다 신속하고 정확하게 개입할 수 있도록 도와주며, 심각한 정신 건강 문제로 발전하기 전에 예방 조치를 취할 수 있게 합니다. 이는 전 세계적으로 정신 건강 문제를 해결하는 데 큰 기여를 할 수 있습니다.

고객 서비스 및 사용자 경험 개선
기업들은 고객 서비스에서 감정 인식 기술을 활용하여 고객의 감정 상태를 실시간으로 파악할 수 있습니다. 이를 통해 고객의 불만을 신속하게 해결하고, 긍정적인 경험을 제공함으로써 고객 만족도를 높일 수 있습니다. 또한, 개인화된 서비스 제공이 가능해져, 사용자는 자신이 필요로 하는 도움을 더욱 빠르고 정확하게 받을 수 있습니다. 이는 고객 충성도를 높이고, 기업의 성공에 기여할 수 있습니다.

인간-컴퓨터 상호작용의 향상
감정 인식 기술은 인간-컴퓨터 상호작용(HCI)을 크게 향상시킬 수 있습니다. 예를 들어, 감정을 이해하고 반응하는 인공지능 비서나 로봇은 사용자와의 상호작용에서 더 자연스럽고 인간적인 경험을 제공할 수 있습니다. 이는 교육, 엔터테인먼트, 의료 등 다양한 분야에서 사람들의 삶의 질을 높이는 데 기여할 수 있습니다. 특히, 감정을 이해하고 반응하는 교육용 로봇은 학생들의 학습 동기를 유발하고, 학습 효과를 극대화할 수 있습니다.

사회적 문제 해결
감정 분석은 사회적 문제를 해결하는 데에도 중요한 도구가 될 수 있습니다. 예를 들어, 소셜 미디어에서 발생하는 혐오 발언이나 사이버 불링을 감지하여, 이를 사전에 방지하고 대응할 수 있습니다. 이는 인터넷 사용 환경을 더욱 안전하게 만들고, 사회적 갈등을 줄이는 데 기여할 수 있습니다. 또한, 대규모의 데이터를 분석하여 사회적 트렌드나 집단의 감정 변화를 파악함으로써, 정책 결정자들이 보다 효과적인 사회 정책을 수립하는 데 도움을 줄 수 있습니다.

인간 감정의 이해와 연구
딥러닝 기반 감정 인식 연구는 인간 감정의 복잡성을 이해하는 데 중요한 기여를 합니다. 이는 심리학, 사회학, 인류학 등 다양한 학문 분야에서 인간 감정을 더 깊이 연구하고, 이를 바탕으로 새로운 이론을 개발하는 데 도움을 줄 수 있습니다. 또한, 감정 인식 기술은 예술 창작, 문화 연구 등 감정이 중요한 역할을 하는 분야에서도 혁신적인 변화를 이끌어낼 수 있습니다.

결론적으로, 딥러닝을 이용한 감정 인식 연구는 다양한 사회적, 학문적, 경제적 이점을 제공하며, 인류의 삶을 더 나은 방향으로 이끌어갈 수 있는 잠재력을 가지고 있습니다. 이러한 연구를 지속하고 발전시키는 것은 우리의 삶의 질을 향상시키고, 더 나은 사회를 만드는 데 중요한 역할을 할 것입니다.

- What do you want to see at the end?

딥러닝 기반 감정 인식 기술을 통해 정신 건강 관리, 고객 서비스, 인간-컴퓨터 상호작용, 사회적 문제 해결 등 다양한 분야에서 실질적인 변화를 이루고자 합니다. 이 기술은 사람들의 온라인 활동과 소셜 미디어 게시물에서 감정을 분석하여 우울증, 불안, 스트레스 등의 문제를 조기에 발견하고 예방하며, 고객의 감정을 실시간으로 파악하여 더 나은 서비스와 사용자 경험을 제공할 수 있습니다. 또한, 혐오 발언이나 사이버 불링을 감지하여 안전한 인터넷 환경을 조성하고, 대규모 데이터를 분석하여 사회적 트렌드와 감정 변화를 파악함으로써 효과적인 정책 수립을 지원합니다. 궁극적으로, 이 연구를 통해 인간 감정의 복잡성을 이해하고 다양한 학문 분야에서 새로운 이론과 실천 방안을 개발하며, 예술과 문화 연구 등에서도 혁신적인 변화를 이끌어낼 수 있기를 바랍니다. 이를 위해, 과거 데이터를 기반으로 미래의 감정을 예측하는 모델을 개발하여, 사람들이 더 나은 의사결정을 할 수 있도록 돕고자 하는 모델을 기반으로 합니다.

-------------------------
# III.DataSets
커뮤니티 기반의 독립 연구소인 DAIR.AI에서 제공하는 'Emotion Dataset'을 이용함.

해당 데이터는 twitter API를 통해 수집된 영어문장을 여섯가지 기본감정들(anger, fear, joy, love, sadness, surprise)로 분류되었음.

선행 연구인 ‘CARER: Contextualized Affect Representations for Emotion Recognition’의 접근을 기반으로 데이터가 가공처리 됨.

Prior research Link : <https://aclanthology.org/D18-1404.pdf>  

Data link : <https://github.com/dair-ai/emotion_dataset>

## DataSets info

'Emotion Dataset' 중 학습을 위해 제공한 split data를 사용함.

![데이터파일](https://github.com/subineda01/HY-AI-x-DeepLearnig/blob/main/image/dataset.png)

train.csv(16,000), validation.csv(2,000), test.csv(2,000)
-> 총 20,000개의 데이터 (1968KB)


## Data example
```sh
"text" : "im feeling quite sad and sorry for myself but ill snap out of it soon",
"label": 0
```

## Features
- text : 한 개의 문장으로 구성된 string 형태의 feature
- label : 감정을 분류한 라벨로 int 형태의 feature, 6가지 상태를 표현

| Emotion | label |
| ------- | ------- |
| sadness | 0 |
| joy | 1 |
| love | 2 |
| anger | 3 |
| fear | 4 |
| surprise | 5 |



-----------------------
# III.Methodology
### 앙상블 기법
앙상블 기법은 여러 모델의 예측을 결합하여 최종 예측을 도출하는 방법으로, 개별 모델의 단점을 보완하고 성능을 향상시킬 수 있음
일반적으로 앙상블 기법은 과적합을 줄이고 모델의 일반화 성능을 향상시키는데 유리함

### 앙상블 기법 종류
1. 배깅 : 여러 모델을 병렬로 학습시키고, 각 모델의 예측을 평균 또는 투표 방식으로 결합하는 방식 ex) Random Forest
   
    ![image](https://github.com/subineda01/HY-AI-x-DeepLearnig/assets/144909753/86028d89-58c0-4fac-8e13-ea390d1a465a)

2. 부스팅 : 모델을 순차적으로 학습시키고, 이전 모델이 잘못 예측한 샘플에 가중치를 부여하여 다음 모델을 학습시키는 방식 ex) XGBoost, LightGBM
   
   ![image](https://github.com/subineda01/HY-AI-x-DeepLearnig/assets/144909753/08a8e8c2-2b9b-472b-8b56-7fa1f7e2490c)


3. 스태킹 : 여러 다른 유형의 모델을 학습시키고, 이들 모델의 예측을 기반으로 메타 모델을 학습시켜 최종 예측을 도출하는 방식
   
![image](https://github.com/subineda01/HY-AI-x-DeepLearnig/assets/144909753/c255d052-0b30-4a5a-bd94-6266931866b1)

Machine Reading Comprehension 에서 앙상블 접근 방식이 out of distribution의 정확도를 개선하는데 있어 효과적이라는 방식임
근거 논문 : https://ar5iv.labs.arxiv.org/html/2107.00368
따라서 저희는 다양한 대규모 분류 모델들을 학습시킨 뒤 앙상블 기법을 사용하여 모델의 정확도를 더 향상시키는 방식을 사용하려 합니다.
이중에서도 가중치를 동일하게 하는 equal weighting 방식을 사용할 겁니다.

### Equal Weighting
![image](https://github.com/subineda01/HY-AI-x-DeepLearnig/assets/144909753/60497872-bdb2-4a56-a237-19c2173c2e71)

1. 평균 : 각 모델의 예측 확률을 평균내어 최종 예측을 도출하는 방식. 모든 모델의 예측을 동일하게 고려함
2. 곱셈 : 각 모델의 예측 확률을 곱하여 최종 예측을 도출하는 방식. 모든 모델이 특정 위치에 대해 높은 확률을 보일 때 그 위치를 강조함
3. 최대값 : 각 모델의 예측 확률 중 가장 높은 값을 선택하여 최종 예측을 도출. 단 하나의 모델이라도 높은 확신을 가진 위치를 강조함
4. 최소값 : 각 모델의 예측 확률 중 가장 낮은 값을 선택하여 최종 예측을 도출. 가장 자신감이 낮은 모델의 예측을 고려하여 가장 보수적인 접근을 취함
이 중 평균을 취하는 것이 일반적인 경우에 안정적이며 모든 모델의 예측을 균형있게 반영하기에 평균을 취하는 방식을 택했습니다.

다음으로는 앙상블 기법에 활용할 모델들을 소개합니다.

### 1. BertForSequenceClassification
위 모델은 Hugging Face의 Transformer 라이브러리에서 제공하는 모델로 텍스트 분류 작업을 위해 설계된 BERT 기반 모델입니다. 이 모델은 BERT의 기본 아키텍쳐 위에 분류를 위한 추가 레이어를 포함하고 있습니다.'

전체구조

![image](https://github.com/subineda01/HY-AI-x-DeepLearnig/assets/144909753/18a71006-4452-4258-93b4-3a8a0c0ff3ab)

모델은 크게 두가지 구조인 BertModel과 Classifier로 이루어져 있습니다. BertModel은 Transformer layer가 여러겹으로 쌓여있는 본체입니다. 이는 BertEmbedding 부분과 BertEncoder부분으로 나누어져 있습니다. BertEmbedding은 문장을 입력으로 받아 token, segment, position을 임베딩하여 값으로 만들고 더해서 반환해주는 역할을 합니다.

BertEmbedding

![image](https://github.com/subineda01/HY-AI-x-DeepLearnig/assets/144909753/589d2e7d-aeda-44d5-8a0c-9f73000fd8b6)

BertEncoder

임베딩 되어 있는 값들을 토대로 Multi-Head Attention을 통해 입력 토큰 간의 관계를 학습합니다. 이후 어텐션의 출력을 반환하고 Residual Connection을 통해 인코딩을 완료합니다.

이후 클래스 수에 맞는 출력 벡터로 변환되어 소프트맥스 함수를 통해 출력 벡터를 확률 분포로 변환하여 최종 예측을 진행합니다.

